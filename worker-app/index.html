<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>工地請料 App</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <div class="app-header"><span id="header-title">身份驗證</span></div>
        <div class="app-content-wrapper">
            <div id="app-content">
                <!-- Step 0: Login -->
                <div id="step0-login" class="step active">
                    <h3>步驟 1: 請選擇您的姓名</h3>
                    <select id="user-select"><option value="">載入中...</option></select>
                    <button id="login-btn" class="btn-primary" disabled>下一步 →</button>
                </div>

                <!-- Step 1: Main Menu -->
                <div id="step-main-menu" class="step">
                    <h3>主選單</h3>
                    <div class="main-menu">
                        <button id="go-to-order-btn" class="btn-menu">叫貨</button>
                        <button id="go-to-return-btn" class="btn-menu">退貨</button>
                        <button id="go-to-log-btn" class="btn-menu">工作日誌</button>
                    </div>
                    <button id="back-to-login-from-menu-btn" class="btn-secondary">← 返回</button>
                </div>

                <!-- Step 2: Project Info -->
                <div id="step1-project" class="step">
                    <h3>步驟 2: 選擇施工專案</h3>
                    <select id="project-select"><option value="">載入中...</option></select>
                    <input type="text" id="delivery-address" placeholder="送貨地點">
                    <input type="date" id="delivery-date" placeholder="送貨日期">
                    <div class="btn-group">
                        <button id="back-to-main-menu-btn" class="btn-secondary">← 返回主選單</button>
                        <button id="select-project-btn" class="btn-primary" disabled>下一步 →</button>
                    </div>
                </div>

                <!-- Step 3: Material Selection -->
                <div id="step2-materials" class="step">
                    <h3 id="material-title">步驟 3: 選擇品項</h3>
                    <div class="search-wrapper">
                        <input type="search" id="search-materials" placeholder="🔍 搜尋全部品項...">
                    </div>
                    <div class="breadcrumb" id="breadcrumb"></div>
                    <div class="selection-container">
                        <div id="category-selection" class="selection-grid"></div>
                        <div id="subcategory-selection" class="selection-grid" style="display: none;"></div>
                        <div id="thickness-selection" class="selection-grid" style="display: none;"></div>
                        <div id="size-selection" class="selection-list" style="display: none;"></div>
                    </div>
                    <div class="btn-group">
                        <button id="back-to-project-btn" class="btn-secondary">← 返回</button>
                        <button id="go-to-preview-btn" class="btn-primary">下一步：預覽</button>
                    </div>
                </div>

                <!-- Step 4: Preview and Submit -->
                <div id="step3-preview" class="step">
                    <h3>步驟 4: 預覽與確認</h3>
                    <div class="preview-container">
                        <h4>訂單內容</h4>
                        <ul id="preview-item-list"></ul>
                    </div>
                    <div class="additional-info">
                        <h4>收貨資訊</h4>
                        <input type="tel" id="user-phone" placeholder="師父電話">
                        <input type="text" id="recipient-name" placeholder="收貨人">
                        <input type="tel" id="recipient-phone" placeholder="收貨人電話">
                    </div>
                    <div class="btn-group">
                        <button id="back-to-materials-btn" class="btn-secondary">← 返回修改</button>
                        <button id="submit-request-btn" class="btn-primary btn-submit">確認送出</button>
                    </div>
                </div>

                <!-- Step 5: Success -->
                 <div id="step4-success" class="step">
                    <div class="success-animation">
                       <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg>
                    </div>
                    <h3>✅ 送出成功！</h3>
                    <p>採購人員已在後台看到您的請購需求。</p>
                    <button id="new-request-btn" class="btn-primary">建立新的請購單</button>
                </div>

                <!-- Return Step 1 -->
                <div id="step-return" class="step">
                    <h3>退貨登記</h3>
                    <select id="return-project-select"><option value="">選擇施工專案...</option></select>
                    <input type="text" id="return-item-name" placeholder="退貨品項名稱">
                    <input type="number" id="return-item-quantity" placeholder="退貨數量">
                    <div class="btn-group">
                        <button id="back-to-main-menu-from-return-btn" class="btn-secondary">← 返回主選單</button>
                        <button id="submit-return-btn" class="btn-primary">確認送出</button>
                    </div>
                </div>

                <!-- Return Step 2: Success -->
                <div id="step-return-success" class="step">
                    <div class="success-animation">
                       <svg class="checkmark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 52 52"><circle class="checkmark__circle" cx="26" cy="26" r="25" fill="none"/><path class="checkmark__check" fill="none" d="M14.1 27.2l7.1 7.2 16.7-16.8"/></svg>
                    </div>
                    <h3>✅ 退貨登記成功！</h3>
                    <p>後台人員已收到您的退貨通知。</p>
                    <button id="new-return-btn" class="btn-primary">登記另一筆退貨</button>
                </div>
            </div>
        </div>
        <button id="cart-btn" class="cart-btn-floating">🛒 <span id="cart-count">0</span></button>
        
        <!-- New Slide-in Cart Panel -->
        <div id="cart-side-panel" class="cart-side-panel">
            <div class="cart-header">
                <h3>購物車</h3>
                <button id="close-cart-btn" class="cart-close-btn">&times;</button>
            </div>
            <ul id="cart-item-list" class="selection-list">
                <!-- Cart items will be rendered here -->
            </ul>
            <div class="cart-footer">
                <button id="go-to-preview-from-cart-btn" class="btn-primary">下一步：預覽</button>
            </div>
        </div>
        <div id="cart-overlay" class="cart-overlay"></div>

    </div>
    <script src="script.js"></script>
</body>
</html>